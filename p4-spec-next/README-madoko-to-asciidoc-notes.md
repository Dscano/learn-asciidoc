# Introduction

This is intended to be a quick summary of changes to make from Madoko
markup, to AsciiDoc markup.


# Section headings

Madoko:

```
### Header stacks { #sec-header-stacks }
```

AsciiDoc:

```
[#sec-header-stacks]
==== Header stacks
```

Section headings in Madoko are lines beginning with one or more
consecutive `#` characters.

They should be replaced in AsciiDoc with _one more_ `=` character than
there are `#` characters in Madoko, because a single `=` in AsciiDoc
is used to mark the title of the entire document.  Thus a "level 1
heading" line in AsciiDoc begins with `==`, not `=`.

Put this in the document heading in AsciiDoc to enable section numbering:

```
:sectnums:
```

The auto-numbering of section headings works for section numbers 3
levels deep, e.g. 2.3.4, but not further.  Use the `sectnumlevels`
document property described on this page if you wish to change this
default:

+ https://docs.asciidoctor.org/asciidoc/latest/sections/numbers/

Example:

```
:sectnumlevels: 5
```


# Section cross-reference

Madoko section heading with cross-reference tag name:

```
# Appendix: P4 reserved keywords { #sec-p4-keywords }
```

Madoko cross-reference to that section:
```
Appendix [#sec-p4-keywords]
```

AsciiDoc section heading with ID given manually, rather than
auto-generated from the section name:

```
[#sec-p4-keywords]
== Appendix: P4 reserved keywords
```

AsciiDoc cross-reference to that section:

```
<<sec-p4-keywords>>
```

Note that you should _not_ preceded the markup for the cross-reference
with the word "Section", as AsciiDoc by default expands the
cross-reference to include that word.

You can choose to omit the explicit id, `[#sec-p4-keywords]`, in the
AsciiDoc, _if_ the section name is unique throughout the document.  In
that case, see below for how the ID is auto-generated by AsciiDoc, at
least by default (there are ways to change the auto-generation
algorithm).

The leading `_`, blanks replaced with `_`, and I believe all
non-alphanumeric characters omitted:

```
<<_appendix_p4_reserved_keywords>>
```

Note that at at least `:` and `/` characters in the section title are
omitted, _not_ replaced with an underscore.

If you are not sure, look in the output of `asciidoctor` runs to see
if there are any warning messages about `possible invalid reference`.

Reference in AsciiDoc docs:

+ https://docs.asciidoctor.org/asciidoc/latest/sections/custom-ids/


# Lists of items

Madoko:

```
- First item
- Second item
  * Sub-item
```

AsciiDoc:

```
* First item
* Second item
** Sub-item
```

Former problem: The list in section "Operations on arbitrary-precision
integers" that has sub-bullets, followed by text at the original top
level list item level, is not parsed as desired by AsciiDoctor.  Learn
how to do this in AsciiDoc, if it is possible.

Answer: I found one answer on how to do this here:

+ https://docs.asciidoctor.org/asciidoc/latest/lists/continuation/#enclose-in-open-block


# Bold text

Madoko: `**text to be bold here**`

AsciiDoc: `*text to be bold here*`


# Emphasis

Madoko: `_underscore around a word or phrase_`

AsciiDoc: The same!


# Monospace

Madoko: enclose text within backticks

```
`select`
`select`s
`#`
`{#}`
```

AsciiDoc: Usually the same, except if a backtick ends up in the middle
of a word as in one of the examples above, you must use
double-backticks instead, as shown below.

Also the `#` character is used to surround text to be highlighted in
AsciiDoc, which can trigger if you try to use a single such character
somewhere.  One way to avoid that for monospace text is to surround it
the a backtick and plus sign combination, as shown below.

```
`select`
``select``s
`+#+`
`+{#}+`
```


# Subscript and Superscript

Madoko: `P4~16~` for subscript of the `16`, and `P4^T^` for superscript of the `T`.

AsciiDoc: The same!  No change needed!


# Figure

AsciiDoc:
```
.Caption goes here on one line.
[#fig-tag-for-cross-references]
image::filename.png[]
```


# Figure cross-reference

Madoko:
```
Figure [#fig-tag-for-cross-reference]
```

AsciiDoc:

```
<<fig-tag-for-cross-reference>>
```

Note that the AsciiDoc cross-reference markup expands automatically to
include "Figure <number>", so you should not put "Figure" before the
cross-reference in the AsciiDoc markup.


# Code blocks with syntax highlighting

Madoko:

```
~ Begin P4Example
control MatchActionPipe<H>(in bit<4> inputPort,
                           inout H parsedHeaders,
                           out bit<4> outputPort);
~ End P4Example
```

The above required special definition in the header for a `P4Example`
block.

```
[source,ruby]
----
code block goes here
----
```

TODO: Read AsciiDoc docs on how to enable syntax highlighting for P4:

+ https://docs.asciidoctor.org/asciidoctor/latest/syntax-highlighting/

+ https://docs.asciidoctor.org/asciidoc/latest/verbatim/source-blocks/

Former problem: In Section 6.1 "Very Simple Switch Architecture" there
are some list items with code blocks embedded in the middle of text,
and there was a special syntax in Madoko to make the text after the
code block indented inside the list item as the text before the code
block was.  I do not yet know how to do that in AsciiDoc, if it
provides a way.  In Madoko, such lines consist of only the backslash
character `\`.

Answer: I found one answer on how to do this here:

+ https://docs.asciidoctor.org/asciidoc/latest/lists/continuation/#enclose-in-open-block

TODO: See if AsciiDoctor has a feature to avoid "widow lines",
i.e. only one or two lines of a block appearing on a page, when the
code block is split across multiple pages in PDF.


# Including text from part of a file, marked by tags

See here for how AsciiDoc specifies this:

+ https://docs.asciidoctor.org/asciidoc/latest/directives/include-tagged-regions/


# Tables

TODO: The markup is definitely different in Madoko and AsciiDoc.



# Footnotes

AsciiDoc documentation on footnotes:

+ https://docs.asciidoctor.org/asciidoc/latest/macros/footnote/


# Miscellaneous

TODO: Replace occurrences of `---` for Madoko em dash with whatever
markup is for AsciiDoc em dash.

TODO: In section "Operations on arbitrary-precision integers", an
occurrence of `<=` comes out as a different symbol, not the two
fixed-width symbols `<` followed by `=`, as desired.

TODO: In section "Operations on arbitrary-precision integers", there
are occurrences of LaTeX in-line math formulas like these that are not
rendering as desired.  Learn how to update them:

```
  The expression `a << b` is equal to $a \times 2^b$ while `a >> b`
  is equal to $\lfloor{a / 2^b}\rfloor$.
```


# Special characters

+ arrow pointing left and right with a single horizontal line between
  them, called `&harr;` in Madoko source.
  + Some old discussion here: https://discuss.asciidoctor.org/Double-Arrow-chars-td3918.html
  + Tried `&#8660;`.  Came out as an empty rectangle in PDF output.
  + Tried `&#x12d4;`.  Also came out as an empty rectangle in PDF output.


+ `&rarr;` in Madoko source, arrow pointing right only
  + See here: https://asciidoctor.org/docs/asciidoc-writers-guide/#replacements
  + Tried `&#8594;`.  Produced desired output in PDF output from AsciiDoctor.
